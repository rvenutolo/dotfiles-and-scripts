#!/usr/bin/env bash

set -euo pipefail

if [[ "$#" -eq 0 ]]; then
  if [[ -t 0 ]]; then
    echo "${0##*/}: Expected STDIN" >&2
    exit 2
  fi
  tr '[:lower:]' '[:upper:]'
fi

for file; do
  dirname="$(dirname "${file}")"
  filename="$(basename "${file}")"
  upper_filename="$(echo "${filename}" | tr '[:lower:]' '[:upper:]')"
  target_file="${dirname}/${upper_filename}"
  if [[ "${upper_filename}" != "${filename}" ]]; then
    mv "${file}" "${target_file}"
    echo "${0##*/}: ${file} -> ${target_file}"
  else
    echo "${0##*/}: ${file} not renamed"
  fi
done
